<!DOCTYPE html>
<html>

    <head>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <meta http-equiv="Cache-Control" content="no-cache">
        <!-- <meta http-equiv="refresh" content="7; URL=/" /> -->

        <style type="text/css">
            .error {color:#000; font-family:Arial, sans-serif; text-align: center; position: absolute; top: 50%; left: 50%; -moz-transform: translateX(-50%) translateY(-50%); -webkit-transform: translateX(-50%) translateY(-50%); transform: translateX(-50%) translateY(-50%);}
            .error-fon {font-weight:bold; color:#d0e3f7;}
            .error-text-top {font-size:16px; color:#434141}
            hr { display: block; height: 10px; border: 0; border-top: 1px solid #ccc; margin: 1em 0; padding: 0; }
        </style>

        <title>403 Access denied</title>

    </head>

    <body>

        <div class="error">

            <div class="error-fon">
                <font style="font-size:240px;">403</font>
                <br>
                <font style="font-size:40px;">ACCESS IS BLOCKED</font>
            </div>

            <br>

            <div class="error-text-wrap">
                <div class="error-text-top">
                    <hr>
                    <p style="text-align: justify;">
                        Suspicious activity. If the request is blocked by mistake, please email us at 
                        %PUT_YOUR_SUPPORT_EMAIL_HERE% and be sure to include technical information below
                        (domain, IP, request ID), or try again in 5 minutes.
                    </p>

                    <hr>
                    <p>
                        <table style="text-align: left; margin: auto">
                        <tr>
                            <td>
                                <code style="font-size:14px;"> Domain:</code>
                            </td>
                            <td>
                                <code style="font-size:14px;"> <span id="domain">-</span> </code>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code style="font-size:14px;"> IP address:</code>
                            </td>
                            <td>
                                <code style="font-size:14px;"> <span id="ip">-</span> </code>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <code style="font-size:14px;"> Request ID:</code>
                            </td>
                            <td>
                                <code style="font-size:14px;"> <span id="id">-</span> </code>
                            </td>
                        </tr>
                        </table>
                    </p>

                </div>

                <script type="application/javascript">

                    function replace() {
                        window.location.replace('/');
                    }

                    const req = new XMLHttpRequest();

                    req.open('GET', document.location, false);
                    req.send(null);

                    const req_id = req.getResponseHeader('x-request-id');
                    const req_domain = req.getResponseHeader('host');
                    let req_ip = req.getResponseHeader('x-remote-ip');
                    const req_bt = req.getResponseHeader('nemesidawaf-bt');

                    if (req_bt == 6 || req_bt == 7 || req_bt == 8 || req_bt == 10)
                    {
                        req_ip = req_ip  + " (IP has temporary blocked)";
                    }

                    document.getElementById('domain').innerHTML = req_domain;
                    document.getElementById('ip').innerHTML = req_ip;
                    document.getElementById('id').innerHTML = req_id;

                    if (req_bt != 0 && req_bt != 6 && req_bt != 7 && req_bt != 8 && req_bt != 10)
                    {
                        setTimeout(replace,3000);
                    }

                </script>

            </div>

        </div>

    </body>

</html>